{
  "version": 3,
  "file": "DriveBarUC.js",
  "sourceRoot": "../../../src/exit/uc",
  "sources": [
    "DriveBarUC.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\nimport $       from 'jquery'\nimport * as d3 from 'd3'\nimport Util    from '../util/Util.js'\n\nclass DriveBarUC\n\n  # @port [0,0,92,33] @land =[0,0,100,50\n  constructor:( @stream, @role, @port, @land ) ->\n    @name     = 'DriveBar'\n    @lastTrip = { name:'' }\n    @created  = false\n    @screen   = null # Set by position() updated by position()\n    Util.noop( @onScreenTransform )\n\n  html:() ->\n    @htmlId = Util.id(@name,@role)                                          # For createSvg()\n    \"\"\"<div id=\"#{@htmlId}\" class=\"#{Util.css(@name)}\"></div>\"\"\"  # May or may not need ext for CSS\n\n  ready:() ->\n    @$ = $( @html() )\n\n  position:( screen ) ->\n    # Util.dbg( 'DriveBarUC.position()', @role, screen )\n    @screen      = screen\n    #@screenOrig = screen\n    Util.cssPosition( @$, @screen, @port, @land )\n    [@svg,@$svg,@g,@$g,@gId,@gw,@gh,@y0] = @createSvg( @$, @htmlId, @name, @role, @svgWidth(),  @svgHeight(), @barTop() )\n    @subscribe()\n\n  subscribe:() ->\n    @stream.subscribe( 'Location', 'Deals', (location) => @onLocation( location ) )\n    @stream.subscribe( 'Screen',   'Deals', (screen)   => @onScreen(   screen   ) )\n    @stream.subscribe( 'Trip',     'Deals', (trip)     => @onTrip(     trip     ) )\n\n  onLocation:( location ) ->\n    Util.noop( 'DriveBarUC.onLocation()', @role, location )\n\n  onTrip:( trip ) =>\n    if not @created or trip.name isnt @lastTrip.name\n      @createBars( trip )\n    else\n      @updateFills( trip )\n    @lastTrip = trip\n\n  onScreen:(  screen ) ->\n    @screen = screen\n    Util.cssPosition( @$, @screen, @port, @land )\n    @svg.attr( \"width\", @svgWidth() ).attr( 'height', @svgHeight() )\n    @createBars( @lastTrip )\n\n  # Screenlayout changes base on orientation not working\n  onScreenTransform:( next ) ->\n    prev    = @screen\n    @screen = next\n    Util.cssPosition( @$, @screen, @port, @land )\n    @svg.attr( \"width\", @svgWidth() ).attr( 'height', @svgHeight() )\n    xp = 0\n    yp = 0\n    xn = 0\n    yn = 0\n    [xp,yp] = if prev.orientation is 'Portrait' then [@port[2],@port[3]] else [@land[2],@land[3]]\n    [xn,yn] = if next.orientation is 'Portrait' then [@port[2],@port[3]] else [@land[2],@land[3]]\n    xs = next.width  * xn  / ( prev.width  * xp )\n    ys = next.height * yn  / ( prev.height * yp )\n    @g.attr( 'transform', \"scale(#{xs},#{ys})\" )\n    return\n\n  # index 2 is width index 3 is height\n  svgWidth: () -> if @screen.orientation is 'Portrait' then @screen.width  * @port[2]/100 else @screen.width  * @land[2]/100\n  svgHeight:() -> if @screen.orientation is 'Portrait' then @screen.height * @port[3]/100 else @screen.height * @land[3]/100\n  barHeight:() -> @svgHeight() * 0.33\n  barTop:   () -> @svgHeight() * 0.50\n\n  # d3 Svg dependency\n  createSvg:( $, htmlId, name, ext, width, height, barTop ) ->\n    svgId = Util.svgId(  name, ext, 'Svg' )\n    gId   = Util.svgId(  name, ext, 'G'   )\n    svg   = d3.select('#'+htmlId).append(\"svg:svg\").attr(\"id\",svgId).attr(\"width\",width).attr(\"height\",height)\n    g     = svg.append(\"svg:g\").attr(\"id\",gId) # All tranforms are applied to g\n    $svg  = $.find( '#'+svgId )\n    $g    = $.find( '#'+gId   )\n    [svg,$svg,g,$g,gId,width,height,barTop]\n\n  createBars:( trip ) ->\n    d3.select('#'+@gId).selectAll(\"*\").remove()\n    @mileBeg  = trip.begMile()\n    @mileEnd  = trip.endMile()\n    @distance = Math.abs( @mileEnd - @mileBeg )\n    # Util.dbg( 'DriveBarUC.createBars() 1', { mileBeg:@mileBeg, mileEnd:@mileEnd, distance:@distance } )\n    thick    = 1\n    x        = 0\n    y        = @barTop()\n    w        = @svgWidth()\n    h        = @barHeight()\n    @createTravelTime( trip, @g, x, y, w, h )\n    @rect( trip, @g, trip.segments[0], @role+'Border', x, y, w, h, 'transparent', 'white', thick*4, '' )\n    for seg in trip.segments\n      beg   = w * Math.abs( Util.toFloat(seg['StartMileMarker']) - @mileBeg ) / @distance\n      end   = w * Math.abs( Util.toFloat(seg['EndMileMarker'])   - @mileBeg ) / @distance\n      fill  = @fillCondition( seg.segId, trip.conditions )\n      # Util.dbg( 'DriveBarUC.createBars() 2', { segId:seg.segId, beg:beg, end:end,  w:Math.abs(end-beg) } )\n      @rect( trip, @g, seg, seg.segId, beg, y, Math.abs(end-beg), h, fill, 'black', thick, '' )\n    @created  = true\n    return\n\n  createTravelTime:( trip, g, x, y, w, h ) ->\n    Util.noop( h )\n    fontSize  = 18\n    fontSizePx = fontSize + 'px'\n    g.append(\"svg:text\").text(trip.source).attr(\"x\",4).attr(\"y\",y-fontSize).attr('fill','white')\n     .attr(\"text-anchor\",\"start\").attr(\"font-size\",fontSizePx).attr(\"font-family\",\"Droid Sans\")\n    g.append(\"svg:text\").text('TRAVEL TIME').attr(\"x\",w/2).attr(\"y\",y-fontSize*3.3 ).attr('fill','white')\n     .attr(\"text-anchor\",\"middle\").attr(\"font-size\",fontSizePx).attr(\"font-family\",\"Droid Sans\")\n    g.append(\"svg:text\").text(trip.etaHoursMins()).attr(\"x\",w/2).attr(\"y\",y-fontSize*2.2 ).attr('fill','white')\n     .attr(\"text-anchor\",\"middle\").attr(\"font-size\",fontSizePx).attr(\"font-family\",\"Droid Sans\")\n    g.append(\"svg:text\").text(trip.destination).attr(\"x\",w-4).attr(\"y\",y-fontSize ).attr('fill','white')\n     .attr(\"text-anchor\",\"end\").attr(\"font-size\",fontSizePx).attr(\"font-family\",\"Droid Sans\")\n\n  fillCondition:( segId, conditions ) ->\n    Conditions = @getTheCondition( segId, conditions )\n    return 'gray' if not Conditions? or not Conditions.AverageSpeed?\n    @fillSpeed( Conditions.AverageSpeed )\n\n  # Brute force array interation\n  getTheCondition:( segId, conditions ) ->\n    for  condition in conditions\n      if condition.SegmentId? and condition['Conditions']?\n        return condition['Conditions'] if segId is condition.SegmentId\n    undefined\n\n  fillSpeed:( speed ) ->\n    fill = 'gray'\n    if      50 < speed                 then fill = 'green'\n    else if 25 < speed and speed <= 50 then fill = 'yellow'\n    else if 15 < speed and speed <= 25 then fill = 'red'\n    else if  0 < speed and speed <= 15 then fill = 'black'\n    fill\n\n  updateFills:( trip ) ->\n    for condition in trip.conditions\n      segId = Util.toInt(condition.SegmentId)\n      fill  = @fillSpeed( condition['Conditions'].AverageSpeed )\n      @updateRectFill( segId, fill )\n    return\n\n  rect:( trip, g, seg, segId, x0, y0, w, h, fill, stroke, thick, text ) ->\n\n    svgId = Util.svgId( @name, segId.toString(), @role )\n\n    onClick = () =>\n      `x = d3.mouse(this)[0]`\n      mile  = @mileBeg + (@mileEnd-@mileBeg) *  x / @svgWidth()\n      console.log( 'DriveBar.rect()', { segId:segId, beg:seg['StartMileMarker'], mile:Util.toFixed(mile,1), end:seg['EndMileMarker'] } )\n      @doSeqmentDeals(trip,segId,mile)\n\n    g.append(\"svg:rect\").attr('id',svgId).attr(\"x\",x0).attr(\"y\",y0).attr(\"width\",w).attr(\"height\",h).attr('segId',segId)\n     .attr(\"fill\",fill).attr(\"stroke\",stroke).attr(\"stroke-width\",thick)\n     .on('click',onClick) #.on('mouseover',onMouseOver)\n\n    if text isnt ''\n      g.append(\"svg:text\").text(text).attr(\"x\",x0+w/2).attr(\"y\",y0+h/2+2).attr('fill',fill)\n       .attr(\"text-anchor\",\"middle\").attr(\"font-size\",\"4px\").attr(\"font-family\",\"Droid Sans\")\n    return\n\n  doSeqmentDeals:( trip, segId, mile ) ->\n    deals = trip.getDealsBySegId( segId )\n    Util.dbg( 'DriveBarUC.doSeqmentDeals()', deals.length )\n    if deals.length > 0\n       deals[0].exit = Util.toInt(mile)\n       @stream.publish( 'Deals', deals )\n\n\n  updateRectFill:( segId, fill ) ->\n    rectId = Util.svgId( @name, segId.toString(), @role )\n    rect   = @$svg.find('#'+rectId)\n    rect.attr( 'fill', fill )\n    return\n\n`export default DriveBarUC`\n"
  ]
}