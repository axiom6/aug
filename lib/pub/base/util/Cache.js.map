{
  "version": 3,
  "file": "Cache.js",
  "sourceRoot": "../../../src/base/util",
  "sources": [
    "Cache.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n# import WorkerJS from '/Worker.js'\n\nclass Cache\n\n  constructor:( @stream ) ->\n    # WorkerJS.cacheName = 'Axiom'\n    @register('./Worker.js' )\n\n  register:( swUrl ) ->\n\n    if not navigator['serviceWorker']?\n      console.error( \"Cache\", \"This browser does not suppor service workers\")\n      return\n\n    navigator.serviceWorker.register( swUrl, { scope: './' } )\n      .then( (registration) =>\n        serviceWorkerRegistration = null\n        if registration.installing?\n          serviceWorkerRegistration = registration.installing;\n        else if registration.waiting?\n          serviceWorkerRegistration = registration.waiting\n        else if registration.active\n          serviceWorkerRegistration = registration.active\n\n        if serviceWorkerRegistration?\n          @publish( 'Register', 'Success' ) )\n          #serviceWorkerRegistration.addEventListener('statechange', (event) =>\n          #  @publish( 'StateChange', event.target.state ) ) )\n\n      .catch( (error) =>\n        @publish( 'Register', { swUrl:swUrl }, error ) )\n\n  publish:( status, text, error=null ) ->\n    object       = { status:status, text:text }\n    object.error = error if error?\n    @stream.publish( @subject, object )\n    return\n\n  subscribe:() ->\n    @stream.subscribe( @subject, 'Cache', @consoleStatus )\n\n  consoleStatus:( object ) ->\n    if object.error?\n      console.error( 'Cache', { status:object.status, text:object.text, error:object.error } )\n    # else\n      # console.log(   'Cache', { status:object.status, text:object.text } )\n    return\n\n  quota:() =>\n    navigator['storageQuota'].queryInfo(\"temporary\").then( (info) ->\n      @publish( 'Quota', \"Quota:#{info.quota} Usage: #{info.usage}\") )\n    return\n\n  quotaGranted:() =>\n    navigator.storage.requestPersistent().then( (granted) =>\n      @publish( 'QuotaGranted', granted ) )\n    return\n\n  onlineEvent:() =>\n    window.addEventListener(\"load\", () =>\n      handleNetworkChange = (event) =>\n        if event is false then {}\n        status = if navigator.onLine then 'Online' else 'Offline'\n        @publish( status, 'Cache.onlineEvent()' )\n        return\n      window.addEventListener(\"online\",  handleNetworkChange )\n      window.addEventListener(\"offline\", handleNetworkChange ) )\n    return\n\nexport default Cache"
  ]
}